From 9d4edfc419cdb2868a6a69bf1ed4565478789a35 Mon Sep 17 00:00:00 2001
From: David McKinney <mckinney@subgraph.com>
Date: Wed, 8 Jul 2020 14:07:06 +0000
Subject: [PATCH] Remove calendar server, fix build

---
 js/dbusServices/meson.build               |  2 +-
 meson.build                               | 10 +++++-----
 src/meson.build                           |  2 +-
 subprojects/extensions-app/js/meson.build |  2 +-
 subprojects/extensions-app/meson.build    |  2 +-
 5 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/js/dbusServices/meson.build b/js/dbusServices/meson.build
index 68e8bd1..16efaeb 100644
--- a/js/dbusServices/meson.build
+++ b/js/dbusServices/meson.build
@@ -27,7 +27,7 @@ foreach service, dir : dbus_services
 
   serviceconf = configuration_data()
   serviceconf.set('service', service)
-  serviceconf.set('gjs', gjs.path())
+  serviceconf.set('gjs', gjs)
   serviceconf.set('pkgdatadir', pkgdatadir)
 
   configure_file(
diff --git a/meson.build b/meson.build
index 58f66cd..1dc4729 100644
--- a/meson.build
+++ b/meson.build
@@ -19,8 +19,8 @@ cogl_pango_pc = 'mutter-cogl-pango-' + mutter_api_version
 libmutter_pc = 'libmutter-' + mutter_api_version
 libmutter_test_pc = 'libmutter-test-' + mutter_api_version
 
-ecal_req = '>= 3.33.1'
-eds_req = '>= 3.33.1'
+#ecal_req = '>= 3.33.1'
+#eds_req = '>= 3.33.1'
 gcr_req = '>= 3.7.5'
 gio_req = '>= 2.56.0'
 gi_req = '>= 1.49.1'
@@ -72,8 +72,8 @@ else
 endif
 
 atk_bridge_dep = dependency('atk-bridge-2.0')
-ecal_dep = dependency('libecal-2.0', version: ecal_req)
-eds_dep = dependency('libedataserver-1.2', version: eds_req)
+#ecal_dep = dependency('libecal-2.0', version: ecal_req)
+#eds_dep = dependency('libedataserver-1.2', version: eds_req)
 gcr_dep = dependency('gcr-base-3', version: gcr_req)
 gdk_x11_dep = dependency('gdk-x11-3.0')
 gdk_pixbuf_dep = dependency('gdk-pixbuf-2.0')
@@ -139,7 +139,7 @@ endif
 
 mutter_typelibdir = mutter_dep.get_pkgconfig_variable('typelibdir')
 python = find_program('python3')
-gjs = find_program('gjs')
+gjs = '/usr/bin/gjs'
 
 cc = meson.get_compiler('c')
 
diff --git a/src/meson.build b/src/meson.build
index 53b8b52..5fa9fdf 100644
--- a/src/meson.build
+++ b/src/meson.build
@@ -1,7 +1,7 @@
 service_data = configuration_data()
 service_data.set('libexecdir', libexecdir)
 
-subdir('calendar-server')
+#subdir('calendar-server')
 subdir('hotplug-sniffer')
 subdir('st')
 subdir('tray')
diff --git a/subprojects/extensions-app/js/meson.build b/subprojects/extensions-app/js/meson.build
index f311db6..8f7bba4 100644
--- a/subprojects/extensions-app/js/meson.build
+++ b/subprojects/extensions-app/js/meson.build
@@ -9,7 +9,7 @@ endif
 launcherconf.set('prefix', prefix)
 launcherconf.set('libdir', libdir)
 launcherconf.set('pkgdatadir', pkgdatadir)
-launcherconf.set('gjs', gjs.path())
+launcherconf.set('gjs', gjs)
 
 configure_file(
   input: prgname + '.in',
diff --git a/subprojects/extensions-app/meson.build b/subprojects/extensions-app/meson.build
index 6143eef..a619f63 100644
--- a/subprojects/extensions-app/meson.build
+++ b/subprojects/extensions-app/meson.build
@@ -44,7 +44,7 @@ localedir = join_paths(datadir, 'locale')
 metainfodir = join_paths(datadir, 'metainfo')
 servicedir = join_paths(datadir, 'dbus-1', 'services')
 
-gjs = find_program('gjs')
+gjs = '/usr/bin/gjs'
 appstream_util = find_program('appstream-util', required: false)
 desktop_file_validate = find_program('desktop-file-validate', required: false)
 
